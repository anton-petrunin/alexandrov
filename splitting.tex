\chapter{Line splitting}

\section{Busemann function}

A \index{half-line}\emph{half-line} is a distance-preserving map
from $\RR_{\ge0}=[0,\infty)$ 
to a metric space.
In other words, a half-line is a geodesic defined on the real half-line $\RR_{\ge0}$.
If $\gamma\:[0,\infty)\to \spc{X}$ is a half-line,
then the limit 
\[\bus_\gamma(x)=\lim_{t\to\infty}\dist{\gamma(t)}{x}{}- t\eqlbl{eq:def:busemann*}\]
is called the \index{Busemann function}\emph{Busemann function} of $\gamma$.

(The Busemann function $\bus_\gamma$ mimics the distance function from the ideal point of $\gamma$.)

\begin{thm}{Proposition}\label{prop:busemann}
For any half-line $\gamma$ in a metric space $\spc{X}$,
its Busemann function $\bus_\gamma\:\spc{X}\to \RR$ 
is defined.
Moreover, $\bus_\gamma$ is $1$-Lipschitz and $\bus_\gamma\circ\gamma(t)+t= 0$ for any $t$.

\end{thm}

\parit{Proof.}
By the triangle inequality, the function
\[t\mapsto\dist{\gamma(t)}{x}{}- t\] 
is nonincreasing for any fixed $x$.  

Since $t=\dist{\gamma(0)}{\gamma(t)}{}$, the triangle inequality implies that
\[\dist{\gamma(t)}{x}{}- t\ge-\dist{\gamma(0)}{x}{}.\]
Thus the limit in \ref{eq:def:busemann*} is defined,
and it is 1-Lipschitz as a limit of 1-Lipschitz functions.
The last statement follows since 
$\dist{\gamma(t)}{\gamma(t_0)}{}\z=t-t_0$ for all large~$t$.
\qeds

Note that \ref{ex:distfun-semiconcave} implies the following.

\begin{thm}{Observation}\label{ex:busemann-CBB}
Any Busemann function on a geodesic $\Alex{0}$ space is concave.
\end{thm}

\section{Splitting theorem}

A \index{line}\emph{line} is a distance-preserving map
from $\RR$ to a metric space.
In other words, a line is a geodesic defined on the real line $\RR$.


Let $\spc{X}$ be a metric space and $A,B\subset \spc{X}$.
We will write 
\[\spc{X}=A\oplus B\]\index{$A\oplus B$}
if there are projections $\proj_A\:\spc{X}\to A$ 
and 
$\proj_B\:\spc{X}\to B$
such that 
\[\dist[2]{x}{y}{}=\dist[2]{\proj_A(x)}{\proj_A(y)}{}+\dist[2]{\proj_B(x)}{\proj_B(y)}{}\]
for any two points $x,y\in \spc{X}$.

Note that if 
\[\spc{X}=A\oplus B\]
then 
\begin{itemize}
\item $A$ intersects $B$ at a single point,
\item both sets $A$ and $B$ are convex sets in $\spc{X}$;
the latter means that any geodesic with the ends in $A$ (or $B$) lies in $A$ (or $B$). 
\end{itemize}

\begin{thm}{Line splitting theorem}\label{thm:splitting}
Let $\spc{L}$  be a complete geodesic $\Alex{0}$ space
and $\gamma$ be a line in $\spc{L}$. 
Then 
\[\spc{L}=\spc{L}'\oplus \gamma(\RR)\]
for some subset $\spc{L}'\subset \spc{L}$.
\end{thm}

Before going into the proof, let us state a corollary of the theorem.

\begin{thm}{Corollary}\label{cor:splitting}
Let $\spc{L}$ be a complete geodesic $\Alex{0}$ space. 
Then there is an isometric splitting
\[
\spc{L}=\spc{L}'\oplus H
\]
where $H\subset \spc{L}$ is a subset isometric to a Hilbert space, and $\spc{L}'\subset \spc{L}$ is a convex subset that contains no line. 
\end{thm}

The following lemma is closely relevant to the first distance estimate (\ref{thm:dist-est}); its proof goes along the same lines.

\begin{thm}{Lemma}\label{lem:dist-estimate}
Suppose $f\:\spc{L}\to\RR$ be a concave 1-Lipschitz function on a geodesic $\CBB(0)$ space $\spc{L}$.
Consider two $f$-gradient curves $\alpha$ and~$\beta$.
Then for any $t, s\ge 0$ we have
\begin{align*}
&\dist[2]{\alpha(s)}{\beta(t)}{}
\le 
\dist[2]{p}{q}{}+
2\cdot(f(p)-f(q))\cdot(s-t)+ (s-t)^2,
\end{align*}
where $p=\alpha(0)$ and $q=\beta(0)$.
\end{thm}

\parit{Proof.}
Since $f$ is 1-Lipschitz, $|\nabla f|\le1$.
Therefore 
\[f\circ\beta(t)\le f(q)+t\]
for any $t\ge0$.

Set $\ell(t)=\dist{p}{\beta(t)}{}$.
Applying \ref{eq:fist-var-inq+}, we get
\begin{align*}
(\ell^2)^+(t)
&\le 2\cdot \left(f\circ\beta(t)-f(p)\right)\le 
\\
&\le2\cdot\left(f(q)+t-f(p)\right).
\end{align*}
Therefore 
\[\ell^2(t)-\ell^2(0)\le 2\cdot\left(f(q)-f(p)\right)\cdot t + t^2.\]
It proves the needed inequality in case $s=0$.
Combining it with the first distance estimate (\ref{thm:dist-est}), we get the result in case $s\le t$.
The case $s\ge t$ follows by switching the roles of $s$ and $t$.
\qeds


\parit{Proof of \ref{thm:splitting}.} Consider two Busemann functions, $\bus_+$ and $\bus_-$, asociated with half-lines $\gamma:[0,\infty)\to \spc{L}$ and $\gamma:(-\infty,0]\to \spc{L}$ respectively; that is,
\[
\bus_\pm(x)
\df
\lim_{t\to\infty}\dist{\gamma(\pm t)}{x}{}- t.
\]
According to \ref{ex:busemann-CBB}, 
both functions $\bus_\pm$ are concave.

Fix $x\in \spc{L}$.
Since $\gamma$ is a line, we have 
$\bus_+(x)+\bus_-(x)\ge0$.
On the other hand, by \ref{comp-kappa}, 
$f(t)=\distfun_x^2\circ\gamma(t)$ 
is $2$-concave.
In particular, $f(t)\le t^2+at+b$ for some constants $a,b\in\RR$. 
Passing to the limit as $t\to\pm\infty$, we have $\bus_+(x)+\bus_-(x)\le0$.
Hence
\[
\bus_+(x)+\bus_-(x)= 0
\]
for any $x\in \spc{L}$.
In particular, the functions $\bus_\pm$ are \index{affine function}\emph{affine};
that is, they are convex and concave at the same time.

Note that for any $x$,
\begin{align*}
|\nabla_x \bus_\pm|
&=\sup\set{\dd_x\bus_\pm(\xi)}{\xi\in\Sigma_x}=
\\
&=\sup\set{-\dd_x\bus_\mp(\xi)}{\xi\in\Sigma_x}\equiv
\\
&\equiv1.
\end{align*}

Observe that $\alpha$ is a $\bus_\pm$-gradient curve
if and only if $\alpha$ is a geodesic such that $(\bus_\pm\circ\alpha)^+=1$.
Indeed, if $\alpha$ is a geodesic, then $(\bus_\pm\circ\alpha)^+\le 1$ and the equality holds only if $\nabla_\alpha\bus_\pm=\alpha^+$.
Now suppose $\nabla_\alpha\bus_\pm=\alpha^+$.
Then $|\alpha^+|\le 1$ and $(\bus_\pm\circ\alpha)^+=1$; therefore 
\begin{align*}
|t_0-t_1|&\ge \dist{\alpha(t_0)}{\alpha(t_1)}{}\ge
\\
&\ge|\bus_\pm\circ\alpha(t_0)-\bus_\pm\circ\alpha(t_1)=
\\
&=|t_0-t_1|.
\end{align*}

It follows that for any $t>0$, the $\bus_\pm$-gradient flows commute;
that is, 
\[\GF_{\bus_+}^t\circ\GF_{\bus_-}^t=\id_\spc{L}.\]
Setting
\[\GF^t=\left[\begin{matrix}
\GF_{\bus_+}^t&\hbox{if}\ t\ge0\\
\GF_{\bus_-}^t&\hbox{if}\ t\le0
               \end{matrix}\right.\]
defines an $\RR$-action on $\spc{L}$.

Consider the level set $\spc{L}'=\bus_+^{-1}(0)=\bus_-^{-1}(0)$;
it is a closed convex subset of $\spc{L}$, and therefore forms an Alexandrov space.
Consider the map $h\:\spc{L}'\times \RR\to \spc{L}$ defined by $h\:(x,t)\mapsto \GF^t(x)$.
Note that $h$ is onto.
Applying Lemma \ref{lem:dist-estimate} for $\GF_{\bus_+}^t$ and $\GF_{\bus_-}^t$ shows that $h$ is short and non-contracting at the same time; that is, $h$ is an isometry.
\qeds

\section{Polar vectors}

Here we give a corollary of \ref{ex:convergence-grad}.
It will be used to prove basic properties of the tangent space.


\begin{thm}{Anti-sum lemma}\label{lem:minus-sum} 
Let $\spc{L}$ be a complete geodesic $\CBB$ space and $p\in \spc{L}$.

Given two vectors $u,v\in \T_p$, there is a unique vector $w\in \T_p$ such that
\[\langle u,x\rangle +\langle v,x\rangle +\langle w,x\rangle \ge 0\]
for any $x\in \T_p$, and
\[\langle u,w\rangle +\langle v,w\rangle +\langle w,w\rangle =0.\]

\end{thm}

\begin{thm}{Exercise}\label{ex:|antisum|}
Suppose $u,v, w\in \T_p$ are as in \ref{lem:minus-sum}.
Show that 
\[|w|^2\le |u|^2+|v|^2+2\cdot\langle u,v\rangle.\]

\end{thm}


If $\T_p$ were geodesic, then the lemma would follow from the existence  of the gradient, applied to the function $\T_p\to \RR$ defined by $x\mapsto -(\langle u,x\rangle +\langle v,x\rangle )$ which is concave.
However, the tangent space $\T_p$ might fail to be geodesic; see  Halbeisen's example \cite{alexander-kapovitch-petrunin-bigbook}.


Applying the above lemma for $u=v$, we have the following statement.

\begin{thm}{Existence of polar vector}\label{cor:polar}
Let $\spc{L}$ be a complete geodesic $\CBB$ space 
and $p\in \spc{L}$. 
Given a vector $u\in \T_p$,  there is a unique vector $u^*\in\T_p$ such that $\langle u^*,u^*\rangle +\langle u,u^*\rangle = 0$ and
$u^*$ is \index{polar vectors}\emph{polar} to $u$;
that is,
 $\langle u^*,x\rangle +\langle u,x\rangle \ge 0$ for any $x\in \T_p$.

In particular, for any vector $u\in \T_p$ there is a polar vector $u^*\in\T_p$ such that
$|u^*|\le |u|$.
\end{thm}

\begin{thm}{Example}
Let $\spc{L}$ be the upper half plane in $\EE^2$;
that is, $\spc{L}\z=\{(x,y)\in \EE^2\mid y\ge 0\}$.
It is a complete geodesic $\Alex{0}$ space.
For $p=0$, the tangent space $\T_p$ can be canonically identified with $\spc{L}$.
If $y>0$, then $u=(x,y)\in \T_p$ has many polar vectors;
it includes $u^*=(-x,0)$ which is provided by \ref{cor:polar},
but the vector $w=(-x,y)$ is polar as well.

In this case, $w$ is the only polar vector with the same magnitude.
If the dimension is finite, then Milka's lemma guarantees the existence of such a polar vector.
\end{thm}

\parit{Proof of \ref{lem:minus-sum}.}
By \ref{ex:first-var-CBB}, we can choose two sequences of points $a_n,b_n$ such that 
\begin{align*}
\dd_p\distfun_{a_n}(w)&=-\langle\dir{p}{a_n},w\rangle
\\
\dd_p\distfun_{b_n}(w)&=-\langle\dir{p}{b_n},w\rangle
\end{align*}
for any $w\in\T_p$ and $\dir{p}{a_n}\to u/|u|$, $\dir{p}{b_n}\to v/|v|$ as $n\to \infty$

Consider a sequence of functions 
\[f_n=|u|\cdot\distfun_{a_n}+|v|\cdot\distfun_{b_n}.\]
Note that 
\[(\dd_pf_n)(x)=-|u|\cdot\langle \dir{p}{a_n},x\rangle -|v|\cdot\langle \dir{p}{b_n},x\rangle .\]
Thus we have the following uniform convergence for $x\in\Sigma_p$:
\[(\dd_pf_n)(x)\to-\langle u,x\rangle -\langle v,x\rangle \]
as $n\to\infty$,
According to \ref{ex:convergence-grad}, 
the sequence $\nabla_pf_n$ converges.
Let 
\[w=\lim_{n\to\infty}\nabla_pf_n.\]
By the definition of gradient,
\[\begin{aligned}
\langle w,w\rangle &=\lim_{n\to\infty}\langle \nabla_pf_n,\nabla_pf_n\rangle =
&&&%right side
\langle w,x\rangle &=\lim_{n\to\infty}\langle \nabla_pf_n,x\rangle \ge
\\%second line
&=\lim_{n\to\infty}(\dd_p f_n)(\nabla_p f_n)
=
&&&%second line right side
&\ge
\lim_{n\to\infty}(\dd_pf_n)(x)
=
\\%line 3
&=-\langle u,w\rangle -\langle v,w\rangle ,
&&&%line 3 right side
&=-\langle u,x\rangle -\langle v,x\rangle .
\end{aligned}\]
\qedsf












\section{Linear subspace of tangent space}

\begin{thm}{Definition}\label{def:opp+Lin}
Let $\spc{L}$ be a complete geodesic $\Alex{\kappa}$ space, $p\in \spc{L}$ and $u,v\in\T_p$.
We say that vectors $u$ and $v$ are \index{opposite vectors}\emph{opposite}\label{def:opposite:page} to each other, (briefly, $u+v=0$) if $|u|=|v|=0$ or $\mangle(u,v)=\pi$ and $|u|=|v|$.

The subcone
\[\Lin_p=\set{v\in\T_p}{\exists\ w\in\T_p\quad \text{such that}\quad w+v=0}\]
will be called the \index{linear subspace}\emph{linear subcone} of $\T_p$.
\end{thm}

\begin{thm}{Proposition}\label{prop:opposite}
Let $\spc{L}$ be a complete geodesic $\CBB$ space and $p\in \spc{L}$.
Given two vectors $u,v\in\T_p$, the following statements are equivalent:
\begin{subthm}{opposite} $u+v=0$;
\end{subthm}
\begin{subthm}{<x,u>} $\langle u,x\rangle +\langle v,x\rangle =0$ for any $x\in\T_p$;
\end{subthm}
\begin{subthm}{<xi,u>} $\langle u,\xi\rangle +\langle v,\xi\rangle =0$ for any $\xi\in\Sigma_p$.
\end{subthm}
\end{thm}

\parit{Proof.}
The equivalence  \ref{SHORT.<x,u>}$\Leftrightarrow$\ref{SHORT.<xi,u>} is trivial.

The condition $u+v=0$ is equivalent to 
\[\langle u,u\rangle =-\langle u,v\rangle =\langle v,v\rangle ;\]
thus 
\ref{SHORT.<x,u>}$\Rightarrow$\ref{SHORT.opposite}.

Recall that $\T_p$ is $\CBB(0)$.
Note that the hinges $\hinge 0ux$ and $\hinge 0vx$ are adjacent.
By \ref{ex:adjacent-CBB}, $\mangle\hinge 0ux+\mangle\hinge 0vx=0$;
hence \ref{SHORT.opposite}$\Rightarrow$\ref{SHORT.<x,u>}.
\qeds

\begin{thm}{Exercise}\label{prop:two-opp}
Let $\spc{L}$  be a complete geodesic $\CBB$ space and $p\in \spc{L}$.
Then for any three vectors $u,v,w\in\T_p$, if $u+v=0$ and $u+ w=0$ then $v=w$.
\end{thm}

Let $u\in \Lin_p$; that is, $u+v=0$ for some $v\in\T_p$.
Given $s<0$, let 
\[s\cdot u\df (-s)\cdot v.\]
So we can multiply any vector in $\Lin_p$ by any real number (positive and negative).
By \ref{prop:two-opp}, this multiplication is uniquely defined;
by \ref{prop:opposite}; we have identity
\[\langle -v,x\rangle=-\langle v,x\rangle;\]
later we will see that it extends to a linear structure on $\Lin_p$.

\begin{thm}{Exercise}\label{ex:3<,>=0}
Suppose $u,v,w\in\T_p$ are as in \ref{lem:minus-sum}.
Show that
\[\langle u,x\rangle +\langle v,x\rangle +\langle w,x\rangle = 0\]
for any $x\in \Lin_p$.
\end{thm}

\begin{thm}{Exercise}\label{ex:-u}
Let $\spc{L}$ be a complete geodesic $\CBB$ space,
$p\in \spc{L}$ and $u\in \T_p$.
Suppose $u^*\in \T_p$ is provided by \ref{cor:polar};
that is, 
\[\langle u^*,u^*\rangle +\langle u,u^*\rangle = 0
\quad\text{and}\quad
\langle u^*,x\rangle +\langle u,x\rangle \ge 0
\]
for any $x\in \T_p$.
Show that 
\[u=-u^*\quad\Longleftrightarrow\quad|u|=|u^*|.\]
\end{thm}


\begin{thm}{Theorem}\label{thm:lin-subcone}
Let $p$ be a point in a complete geodesic $\Alex{\kappa}$. 
Then $\Lin_p$ is isometric to a Hilbert space.
\end{thm}

\parit{Proof of \ref{thm:lin-subcone}.}
Note that $\Lin_p$ is a closed subset of $\T_p$;
in particular, it is complete.

If any two vectors in $\Lin_p$ can be connected by a geodesic in $\Lin_p$,
then the statement follows from the splitting theorem (\ref{thm:splitting}).
By Menger's lemma (\ref{lem:mid>geod}), it is sufficient to show that for any two vectors $x,y\in\Lin_p$
there is a midpoint $w\in \Lin_p$.

Choose $w\in \T_p$ to be the anti-sum of $u=-\tfrac{1}{2}\cdot x$ and $v=-\tfrac{1}{2}\cdot y$;
see \ref{lem:minus-sum}.
By \ref{ex:|antisum|} and \ref{ex:3<,>=0},
\begin{align*}
|w|^2&\le \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle,
\\
\langle w,x\rangle&= \tfrac12\cdot|x|^2+\tfrac12\cdot\langle x,y\rangle,
\\
\langle w,y\rangle&= \tfrac12\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle,
\end{align*}
It follows that 
\begin{align*}
|x-w|^2
&= |x|^2+|w|^2-2\cdot\langle w,x\rangle\le
\\
&\le \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2-\tfrac12\cdot\langle x,y\rangle=
\\
&=\tfrac14\cdot|x-y|^2.
\end{align*}
That is, $|x-w|\le \tfrac12\cdot|x-y|$, and similarly $|y-w|\le \tfrac12\cdot|x-y|$.
Therefore $w$ is a midpoint of $x$ and $y$.
In addition we get equality 
\[|w|^2= \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle.\]

It remains to show that $w\in\Lin_p$.
Let $w^*$ be the polar vector provided by \ref{cor:polar}.
Note that 
\[|w^*|\le |w|,
\quad
\langle w^*,x\rangle+\langle w,x\rangle=0,
\quad
\langle w^*,y\rangle+\langle w,y\rangle=0.
\]
The same calculation as above shows that $w^*$ is a midpoint of $-x$ and $-y$ and 
\[|w^*|^2= \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle=|w|^2.\]
By \ref{ex:-u}, $w=-w^*$;
hence $w\in\Lin_p$.
\qeds



\begin{thm}{Exercise}\label{ex:grad-dist}
Let $p$ be a point in a complete geodesic $\CBB(\kappa)$ space $\spc{L}$ and $f=\distfun_p$.
Denote by $S$ the subset of points $x\in\spc{L}$ such that $|\nabla_xf|=1$.

\begin{subthm}{ex:grad-dist:G-delta}
Show that $S$ is a dense G-delta set.
\end{subthm}

\begin{subthm}{ex:grad-dist:lin}
Show that 
\[\nabla_xf+\dir xp=0\]
for any 
$x\in S$;
in particular, $\dir xp\in \Lin_x$.
\end{subthm}

\begin{subthm}{}
Show that if $|\nabla_xf|=1$, then $\dd_xf(w)= \langle\nabla_xf,w\rangle$ for any $w\in \T_x$.
\end{subthm}


\end{thm}

Note that \ref{ex:grad-dist:lin} implies the following.

\begin{thm}{Corollary}\label{cor:euclid-subcone}
Given a countable set of points $X$ in a complete geodesic $\Alex{\kappa}$ space $\spc{L}$
there is a G-delta dense set $S\subset\spc{L}$
such that 
$\dir sx\in \Lin_s$
for any $s\in S$ and $x\in X$.
\end{thm}


\section{Menger's lemma}

\begin{thm}{Lemma}\label{lem:mid>geod}
Let $\spc{X}$ be a complete metric space.
Assume that for any pair of points $x,y\in \spc{X}$, 
there is a midpoint~$z$.
Then $\spc{X}$ is a geodesic space.

\end{thm}

This lemma is due to Karl Menger \cite[Section 6]{menger}.

\parit{Proof.}
Choose $x,y\in \spc{X}$;
set $\alpha(0)=x$, and $\alpha(1)=y$.

Let $\alpha(\tfrac12)$ be a midpoint between $\alpha(0)$ and $\alpha(1)$.
Further, let $\alpha(\frac14)$ 
and $\alpha(\frac34)$ be midpoints between the pairs $(\alpha(0),\alpha(\tfrac12))$ 
and $(\alpha(\tfrac12),\alpha(1))$ respectively.
Applying the above procedure recursively,
on the $n$-th step we define $\alpha(\tfrac{k}{2^n})$,
for every odd integer $k$ such that $0<\tfrac k{2^n}<1$, 
as a midpoint of the already defined
$\alpha(\tfrac{k-1}{2^n})$ and $\alpha(\tfrac{k+1}{2^n})$.


This way we define $\alpha(t)$ for all dyadic rationals $t$ in $[0,1]$.
Moreover, $\alpha$ has Lipschitz constant $\tfrac{1}{\dist{x}{y}{}}$.
Since $\spc{X}$ is complete, the map $\alpha$ can be extended continuously to $[0,1]$.
Moreover,
\[\begin{aligned}
\length\alpha&\le \dist{x}{y}{}.
\end{aligned}
\eqlbl{eq:eps-midpoint}
\]
\qedsf

\section{Comments}

The splitting theorem has an interesting history that starts with Stefan Cohn-Vossen \cite{cohn-vossen_line}.
Our proof is based on the idea of Jeff Cheeger and Detlef Gromoll \cite{cheeger-gromoll-split}.

Corollary \ref{cor:euclid-subcone} is the key to the following result: \textit{all reasonable definitions of dimension give the same result on complete geodesic $\CBB$ spaces}.
We might come back to it after studying the opposite curvature bound.
