\chapter{Barycenters}

\section{Definition}

Let us denote by $\Delta^k\subset \RR^{k+1}$\index{$\Delta^m$} 
the \index{standard simplex}\emph{standard $k$-simplex}; 
that is, $\bm{m}=(m_0,\dots,m_k)\in\Delta^k$ if $m_0+\dots+m_k=1$ and $m_i\ge0$ for all $i$.

Consider a point array $\bm{p}=(p_0,\dots,p_k)$ in a Euclidean space $\EE^n$.
Recall that
\[z=m_0\cdot p_0+\dots+m_k\cdot p_k\]
is called barycenter of point array $\bm{p}=p_0,\dots,p_k$ with masses $\bm{m}\z=(m_0,\dots, m_k)\in \Delta^k$.
Equivalently, 
\[z\df \argmin (m_0\cdot f_0+\dots+m_k\cdot f_k),\eqlbl{eq:f-spx}\]
where $f_i=\tfrac12\cdot\distfun_{p_i}^2$ for each $i$, and $\argmin f$\index{$\argmin$} denotes a point of minimum of function $f$.

The map $\spx{}\:\Delta^k\mapsto \EE^n$ defined by $\spx{}\:\bm{m}\mapsto z$ is called barycentric simplex of the array $\bm{p}$.
If needed we may denote this map by $\spx{\bm{p}}$ or, more generally, $\spx{\bm{f}}$.
The latter means that we define the map using \ref{eq:f-spx} for an array of functions $\bm{f}=(f_0,f_1,\dots,f_k)$.
Note that the definition \ref{eq:f-spx} makes sense for any array of functions in a metric space;
altho, in this case, the map might be undefined or nonuniquely defined.

Further, we will work with this definition in $\CAT(0)$ spaces instead of $\EE^n$.
It will be used to define and study dimension of $\CAT$ spaces.
We will use that on a geodesic $\CAT(0)$ space,
functions of the type $f=\tfrac12\cdot\distfun_{p}^2$ are 1-convex; see \ref{ex:convex-distfun}.
Besides that, we will not use $\CAT(0)$ condition for a while.


\section{Barycentric simplex}

\begin{thm}{Theorem}\label{thm:barycenter}
Let $\spc{X}$ be a complete geodesic space 
and $\bm{f}\z=(f_0,\z\dots,f_k)\:\spc{X}\to\RR^{k+1}$
be an array of nonnegative 1-convex locally Lipschitz functions.
Then the barycentric simplex 
$\spx{\bm{f}}\:\Delta^k\to \spc{X}$ is a uniquely defined Lipshitz map.

In particular, we have that 
the barycentric simplex $\spx{\bm{p}}$ any point array $\bm{p}\z=(p_0,\z\dots,p_k)$ in a complete geodesic $\CAT(0)$ space is a uniquely defined Lipshitz map.
\end{thm}


\begin{thm}{Lemma}\label{lem:argmin(convex)}
Suppose $\spc{X}$ is a complete geodesic space and $f\:\spc{X}\z\to\RR$ is a locally Lipschitz, $1$-convex function.
Then $\argmin f$ is uniquely defined.
\end{thm}

\parit{Proof.}
Note that
\begin{clm}{}\label{midpoint}
 if $z$ is a midpoint of the geodesic $[x y]$, then 
\[s\le f(z)
\le
\tfrac{1}{2}\cdot f(x)+\tfrac{1}{2}\cdot f(y)-\tfrac{1}{8}\cdot\dist[2]{x}{y}{},
\]
where $s$ is the infimum of $f$.
\end{clm}

\parit{Uniqueness.}
Assume that $x$ and $y$ are distinct minimum points of $f$. 
From \ref{midpoint} we have
\[f(z)<f(x)=f(y)\] 
--- a contradiction. 

\parit{Existence.}
Fix a point $p\in \spc{X}$, and
let $\Lip\in\RR$ be a Lipschitz constant of $f$ in a neighborhood of $p$.

Choose a sequence of points $p_n\in \spc{X}$ such that $f(p_n)\to s$.
Applying \ref{midpoint} for $x\z=p_n$, $y\z=p_m$, we see that $p_n$ is a Cauchy sequence.
Thus the sequence $p_n$ converges to a minimum point of $f$.
\qeds

\parit{Proof of \ref{thm:barycenter}.}
Since each $f_i$ is $1$-convex, for any $\bm{x}=(x_0,x_1,\dots,x_k)\z\in\Delta^k$ 
the convex combination 
\[\left(\sum_i x_i\cdot f_i\right)\:\spc{X}\to\RR\] 
is also $1$-convex.
Therefore, according to \ref{lem:argmin(convex)}, the barycentric simplex 
%$\spx{\bm{f}}(\bm{x})$ is defined for any $\bm{x}\in\Delta^k$.
$\spx{\bm{f}}$ is uniquely defined on $\Delta^k$.
 
For $\bm{x},\bm{y}\in\Delta^k$,
let 
\begin{align*}
f_{\bm{x}}
&=\sum_i x_i\cdot f_i,
&
f_{\bm{y}}
&=\sum_i y_i\cdot f_i,
\\
p
&=\spx{\bm{f}}(\bm{x}),
&
q
&=\spx{\bm{f}}(\bm{y}),
\end{align*}
Choose a geodesic $\gamma$ from $p$ to $q$;
suppose $s=\dist{p}{q}{}$ and so $\gamma(0)=p$ and $\gamma(s)=q$.
Observe the following:
\begin{itemize}
\item The function $\phi(t)=f_{\bm{x}}\circ\gamma(t)$ has a minimum at $0$. 
Therefore $\phi^+(0)\ge 0$.

\item The function $\psi(t)=f_{\bm{y}}\circ\gamma(t)$ has a minimum at $s$. 
Therefore $\psi^-(s)\ge 0$.
\end{itemize}
From $1$-convexity of $f_{\bm{y}}$, we have
\[\psi^+(0)+\psi^-(s)+s\le0.\]

Let $\Lip$ be a Lipschitz constant for all $f_i$ in a neighborhood $\Omega\ni p$.
Then 
\[\psi^+(0)
\le 
\phi^+(0)+\Lip\cdot\|\bm{x}-\bm{y}\|_1,\] 
where $\|\bm{x}-\bm{y}\|_1=\sum_{i=0}^k|x_i-y_i|$.
It follows that given $\bm{x}\in\Delta^k$, there is a constant $\Lip$ such that
\begin{align*}
\dist{\spx{\bm{f}}(\bm{x})}{\spx{\bm{f}}(\bm{y})}{}
&=
s
\le
\\
&\le 
\Lip\cdot\|\bm{x}-\bm{y}\|_1
\end{align*}
for any $\bm{y}\in\Delta^k$.
In particular, there is $\eps>0$ such that if $\|\bm{x}-\bm{y}\|_1<\eps,$ $\|\bm{x}-\bm{z}\|_1 <\eps$, then $\spx{\bm{f}}(\bm{y})$, $\spx{\bm{f}}(\bm{z})\in\Omega$. 
Thus the same argument as above implies 
\[\dist{\spx{\bm{f}}(\bm{y})}{\spx{\bm{f}}(\bm{z})}{}
\le \Lip\cdot\|\bm{y}-\bm{z}\|_1\]
for any $\bm{y}$ and $\bm{z}$ sufficiently close to $\bm{x}$; that is, $\spx{\bm{f}}$ is locally Lipschitz.
Since $\Delta^k$ is compact, $\spx{\bm{f}}$ is Lipschitz.
\qeds



\section{Convexity of up-set}

\begin{thm}{Definition}\label{def:ordung}
For two real arrays $\bm{v}$, $\bm{w}\in \RR^{\kay+1}$,
$\bm{v}=(v_0,\z\dots,v_\kay)$ 
and 
$\bm{w}=(w_0,\z\dots,w_\kay)$, 
we will write
$\bm{v}\succcurlyeq\bm{w}$ if $v_i\ge w_i$ for each $i$.
\end{thm}

Given a subset $Q\subset \RR^{\kay+1}$, 
denote by $\Up Q$ \label{PAGE.def:Up}
the smallest upper set containing $Q$;
that is,
\begin{align*}
\Up Q 
&=
\set{\bm{v}\in\RR^{\kay+1}}{\exists\, \bm{w}\in Q\ \text{such that}\ \bm{v}\succcurlyeq\bm{w}},
\end{align*}

\begin{thm}{Proposition}\label{thm:up-convex}
Let $\spc{X}$ be a complete geodesic space 
and $\bm{f}\z=(f_0,\z\dots,f_\kay)\:\spc{X}\to\RR^{\kay+1}$ 
be an array of nonnegative 1-convex locally Lipschitz functions.
Consider the set $W=\Up[\bm{f}(\spc{X})]\subset\RR^{k+1}$.
Then 
\begin{subthm}{thm:up-convex:convex}
The set $W$ is convex.
\end{subthm}

\begin{subthm}{thm:up-convex:bry}
$\bm{f}[\spx{\bm{f}}(\Delta^k)]\subset\partial W$.
Moreover, $\bm{f}[\spx{\bm{f}}(\Delta^k)\setminus \spx{\bm{f}}(\partial\Delta^k)]$ is an open set in $\partial W$.
\end{subthm}

\begin{subthm}{thm:up-convex:bry+}
$W=\Up(\bm{f}[\spx{\bm{f}}(\Delta^k)])$; 
in other words, $\Up(\bm{f}[\spx{\bm{f}}(\Delta^k)])\supset\bm{f}(\spc{X})$.
\end{subthm}




\end{thm}

Note that since $\Delta^k$ is compact, we also get that $W$ is closed.

\begin{wrapfigure}{r}{48mm}
\vskip0mm
\centering
\includegraphics{mppics/pic-1106}
\end{wrapfigure}

\parit{Proof.}
Let $V=\bm{f}(\spc{X})\subset\RR^{k+1}$; so $W\z=\Up V$.
Denote by $\bar V$ the closure of $V$.

\parit{\ref{SHORT.thm:up-convex:convex}.}
Convexity of all $f_i$ implies that
for any two points $p,q\in \spc{X}$ and $t\in[0,1]$ we have
\[(1-t)\cdot\bm{f}(p)+t\cdot \bm{f}(q)
\succcurlyeq
\bm{f}\circ\gamma(t),\]
where $\gamma$ denotes a geodesic path from $p$ to $q$. 
Therefore, $W$ is convex.

\parit{\ref{SHORT.thm:up-convex:bry}+\ref{SHORT.thm:up-convex:bry+}.}
Choose $p\in \spx{\bm{f}}(\Delta^k)$.
Note that if $\bm{f}(p)\succcurlyeq\bm{w}$ for some $\bm{w}\in W$, then $\bm{f}(p)=\bm{w}$.
It follows that $\bm{f}(p)\in\partial  W$;
therefore $\bm{f}[\spx{\bm{f}}(\Delta^k)]$ lies in a convex hypersurface $\partial  W$.

Choose $\bm{w}\in W$.
Observe that $\bm{w}\succcurlyeq\bm{v}$ for some $\bm{v}\in \bar V\cap \partial W$.
Note that $W$ is supported at $\bm{v}$ by a hyperplane 
\[\Pi=\set{(x_1,\dots,x_k)\in \RR^k}{m_0\cdot x_0+\dots+m_k\cdot x_k=\const}\]
for some $\bm{m}=(m_0,\dots,m_k)\in\Delta^{\kay}$.
Let $p=\spx{\bm f}(\bm m)$.
By \ref{lem:argmin(convex)}, $\bm{f}(p)\z=\bm{v}$;
in particular $\bm{v}\in V$.

Note that $p\in \spx{\bm{f}}(\Delta^k)\setminus\spx{\bm{f}}(\partial\Delta^k)$ if and only if 
$\bm{f}(p)$ is supported by a plane as above for some $\bm{m}\in\Delta^{\kay}$,
but it is not supported by a plane for some $\bm{m}\in\partial\Delta^{\kay}$.
This condition is open, therefore $\spx{\bm{f}}(\Delta^k)\setminus\spx{\bm{f}}(\partial\Delta^k)$ is an open set.
\qeds

\section{Nondegenerate simplex}

Given an array $\bm{f}=(f_0,\dots,f_k)$,
we denote by $\bm{f}^{\without i}$ the subarray of $\bm{f}$ with $f_i$ removed;
that is, 
\[\bm{f}^{\without i\,}
\df
(f_0,\dots,f_{i-1},f_{i+1},\dots,f_k).\]
It should be clear from the definition that $\spx{\bm{f}^{\without i}}$ 
coincides with the restriction of $\spx{\bm{f}}$ to the corresponding facet of $\Delta^k$.

If $\Im \spx{\bm{f}}$ is not covered by $\Im \spx{\bm{f}^{\without i}}$ for all $i$,
then we say that $\spx{\bm{f}}$ is nondegenerate.
In other words, $\spx{\bm{f}}$ is \index{nondegenerate simplex}\emph{nondegenerate} if 
\[\spx{\bm{f}}(\Delta^k)\setminus \spx{\bm{f}}(\partial \Delta^k)\ne\emptyset.\]

\begin{thm}{Exercise}\label{ex:barysimple}
Let $\spc{U}$ be a complete geodesic $\CAT(0)$ space.

Show that the image 1-dimensional barycentric simplex for a pair of points $p_0,p_1\in\spc{U}$ is the geodesic $[p_0p_1]$.

Construct a $\CAT(0)$ space with a three-point array $(p_0,p_1,p_2)$ such that its barycentric simplex is nondegenerate and noninjective. 
\end{thm}


\begin{thm}{Exercise}\label{lem:nondeg-test-with-balls}
Let $\bm{p}\z=(p_0,\dots p_\kay)$ be a point array 
in a complete length $\CAT(0)$ space $\spc{U}$, 
and $B_i=\cBall[p_i,r_i]$ for some array of positive reals $(r_0,r_1,\dots,r_\kay)$.

\begin{subthm}{}
Suppose $\bigcap_i B_i\ne \emptyset$. Show that 
\[\Im\spx{\bm{p}}\subset \bigcup_i B_i.\]
\end{subthm}

\begin{subthm}{lem:nondeg-test-with-balls:nondeg}
Suppose $\bigcap_i B_i= \emptyset$, but $\bigcap_{i\ne j} B_i\ne \emptyset$ for any $j$.
Show that 
$\spx{\bm{p}}$ is nondegenerate.
\end{subthm}

\begin{subthm}{}
Suppose $\spx{\bm{p}}$ is nondegenerate.
Show that the condition in \ref{SHORT.lem:nondeg-test-with-balls:nondeg} hold for some 
  array of positive reals $(r_0,r_1,\dots,r_\kay)$.
\end{subthm}

\end{thm}



\section{bi-H\"older embedding}

\begin{thm}{Theorem}\label{thm:bihoelder}
Let $\spc{X}$ be a complete geodesic space 
and $\bm{f}\z=(f_0,\z\dots,f_k)\:\spc{X}\to\RR^{k+1}$
be an array of 1-convex locally Lipschitz functions.
Then the set 
\[Z=\spx{\bm{f}}(\Delta^k)\setminus \spx{\bm{f}}(\partial \Delta^k)\]
is $C^{\frac12}$-bi-H\"older to an open domain in $\RR^k$.
\end{thm}

\parit{Proof.}
Let $\proj\:\RR^{k+1}\to\Pi$ be orthogonal projection to the hyperplane $x_0+\dots+x_k=0$.
Let us show that the restriction $\proj\circ \bm{f}|_Z$ is a bi-H\"older embedding.

The map $\proj\circ \bm{f}$ is Lipschitz;
it remains to construct its right inverse and show that it is $C^{\frac12}$-continuous.

Given $\bm{v}=(v_0,v_1,\dots,v_\kay)\in\Pi$, consider the function 
$h_{\bm{v}}\: \spc{X}\to \RR$ defined by
\[h_{\bm{v}}(p)=\max_i\{f_i(p)-v_i\}.\]
Note that $h_{\bm{v}}$ is $1$-convex.
Let 
$$\map(\bm{v})\df\argmin h_{\bm{v}}.$$
According to Lemma~\ref{lem:argmin(convex)}, $\map(\bm{v})$ is uniquely defined.

If $\bm{v}=\proj \bm{f}(p)$, then 
\[f_i\circ \map(\bm{v})\le f_i(p)\]
for any $i$.
In particular, if $p\in \spx{\bm{f}}(\Delta^k)$, then  $p=\map(\bm{v})$.
That is, $\map$ is a right inverse of the restriction $\bm{f}|_{\spx{\bm{f}}(\Delta^k)}$.

Given $\bm{v},\bm{w}\in\RR^{\kay+1}$,
set $p=\map (\bm{v})$ and $q=\map (\bm{w})$.
Since $h_{\bm{v}}$ and $h_{\bm{w}}$ are 1-convex, we have
\begin{align*}
h_{\bm{v}}(q)
&\ge 
h_{\bm{v}}(p)+\tfrac{1}{2}\cdot\dist[2]{p}{q}{},
&
h_{\bm{w}}(p)
&\ge 
h_{\bm{w}}(q)+\tfrac{1}{2}\cdot\dist[2]{p}{q}{}.
\end{align*}
Therefore,
\begin{align*}
\dist[2]{p}{q}{}
&\le 
2\cdot\sup_{x\in\spc{X}}\{ |h_{\bm{v}}(x)-h_{\bm{w}}(x)| \}
\le
\\
&\le 
2\cdot\max_{i}\{|v_i-w_i|\}.
\end{align*}
In particular,
$\map$ is $C^{\frac{1}{2}}$-continuous.

Finally, by \ref{thm:up-convex:bry}, $\bm{f}(Z)$ is a $k$-dimensional manifold, hence the result.
\qeds

\section{Topological dimension}

Let $\spc{X}$ be a metric space and $\{V_\beta\}_{\beta\in\mathcal{B}}$
 be an open cover of $\spc{X}$.
Let us recall two notions in general topology:
\begin{itemize}

\item The \index{order of a cover}\emph{order} of $\{V_\beta\}$ is the supremum of all integers $n$ such that there is a collection of $n+1$ elements of $\{V_\beta\}$ with nonempty intersection.

\item An open cover $\{W_\alpha\}_{\alpha\in\IndexSet}$ of $\spc{X}$ is called a \index{refinement of a cover}\emph{refinement} of  $\{V_\beta\}_{\beta\in\mathcal{B}}$ if for any $\alpha\in\IndexSet$ there is $\beta\in\mathcal{B}$ such that $W_\alpha\subset V_\beta$.

\end{itemize}

\begin{thm}{Definition}\label{def:TopDim}\index{dimension!topological dimension}\index{topological dimension}
Let $\spc{X}$ be a metric space. 
The topological dimension of $\spc{X}$ is defined to be the minimum of nonnegative integers $n$ 
such that for any open cover of $\spc{X}$ there is a finite open refinement with order~$n$.

If no such $n$ exists, the topological dimension of $\spc{X}$ is infinite.

The topological dimension of $\spc{X}$ will be denoted by $\TopDim\spc{X}$.
\end{thm}

The invariants satisfying the following two statements \ref{dim-axiom-norm} and \ref{dim-axiom-sigma} are commonly called ``dimension'';
for that reason, we call these statements axioms.

\begin{thm}{Normalization axiom}
\label{dim-axiom-norm} For any $m\in\ZZ_{\ge0}$,
\[\TopDim\EE^m=m.\]

\end{thm}

\begin{thm}{Cover axiom}\label{dim-axiom-sigma} 
If $\{A_n\}_{n=1}^\infty$ is a countable closed cover of $\spc{X}$, then
\begin{align*}
\TopDim \spc{X}&=\sup\nolimits_n\{\TopDim A_n\}.
\end{align*}

\end{thm}

\parbf{On product spaces.} 
The following inequality holds for arbitrary metric spaces
\begin{align*}
\TopDim  (\spc{X}\times\spc{Y})
&\le 
\TopDim \spc{X}+ \TopDim\spc{Y}.
\end{align*}
It is strict for a pair of Pontryagin surfaces \cite{pontyagin-surface}.

\medskip

\begin{thm}{Definition}
Let $\spc{X}$ be a metric space
and $F\:\spc{X}\to\RR^m$ be  a continuous map.
A point $\bm{z}\in \Im F$ is called a \emph{stable value} of $F$
if there is $\eps>0$ such that $\bm{z}\in\Im F'$ 
for any \emph{$\eps$-close} to $F$ continuous map $F'\:\spc{X}\to\RR^m$,
that is, $|F'(x)-F(x)|<\eps$ for all $x\in \spc{X}$.
\end{thm}



The next theorem follows from \cite[theorems VI 1$\&$2]{hurewicz-wallman}.
(This theorem also holds for non-separable metric spaces \cite{nagata}, \cite[3.2.10]{engelking}). 

\begin{thm}{Stable value theorem}\label{thm:stable-value}
Let $\spc{X}$ be a separable metric space.
Then $\TopDim\spc{X}\ge m$ if and only if there is a map $F\:\spc{X}\to\RR^{m}$ with a stable value.
\end{thm}

\section{Dimension theorem}\label{sec:dim-CAT}

\begin{thm}{Theorem}\label{thm:dim-infty-CBA}
For any proper geodesic $\CAT(0)$ space $\spc{U}$, the following statements are equivalent:

\begin{subthm}{thm:dim-infty-CBA:TopDim}
\[\TopDim \spc{U}\ge m.\]
\end{subthm}

\begin{subthm}{thm:dim-infty-CBA:bary} 
For some $z\in \spc{U}$ there is an array of $m+1$ balls $B_i\z=\oBall(a_i,r_i)$ 
such that 
\[\bigcap_i B_i=\emptyset
\quad\text{and}\quad
\bigcap_{i\ne j} B_i\ne \emptyset
\quad \text{for each $j$}.\]

\end{subthm}


\begin{subthm}{thm:dim-infty-CBA:mnfld} 
There is a $C^{\frac{1}{2}}$-embedding of an open set in $\RR^m$ to $\spc{U}$;
that is, $\map$ is bi-HÃ¶lder with exponent $\tfrac{1}{2}$.
\end{subthm}

\end{thm}


\begin{thm}{Lemma}\label{lem:approximation-cba}
Let $\spc{U}$ be a proper geodesic $\CAT(0)$ space
and $\rho\:\spc{U}\z\to\RR$ be a continuous positive function.
Then there is a locally finite countable simplicial complex $\spc{N}$,
a locally Lipschitz map $\map\:\spc{U}\z\to \spc{N}$, 
and a Lipschitz map $\Psi\:\spc{N}\to\spc{U}$ such that:

\begin{subthm}{lem:approximation-cba:displacement}
The displacement of the composition $\Psi\circ\map\:\spc{U}\to\spc{U}$ is bounded by $\rho$;
that is,
\[\dist{x}{\Psi\circ\map(x)}{}<\rho(x)\] 
for any $x\in\spc{U}$.
\end{subthm}

\begin{subthm}{lem:approximation-cba:im}
If $\TopDim\spc{U}\le m$, 
then the $\Psi$-image of $\spc{N}$ 
coincides with the image of its $m$-skeleton.
\end{subthm}

\end{thm}

\parit{Proof.}
Choose a locally finite countable covering $\set{\Omega_\alpha}{\alpha\in\IndexSet}$ of $\spc{U}$ such that $\Omega_\alpha\subset \oBall(x,\tfrac{1}{3}\cdot\rho(x))$ for any $x\in \Omega_\alpha$. 

Denote by $\spc{N}$ the \index{nerve}\emph{nerve} of the covering $\{\Omega_\alpha\}$;
that is, $\spc{N}$ is an abstract simplicial complex with 
%set of vertexes formed by $\IndexSet$, 
vertex set $\IndexSet$,
such that a finite subset 
$\{\alpha_0,\z\dots,\alpha_n\}\subset\IndexSet$ 
forms a simplex if and only if
\[\Omega_{\alpha_0}
\cap
\dots\cap
\Omega_{\alpha_n}\ne\emptyset.\]

Choose a Lipschitz partition of unity 
$\phi_\alpha\:\spc{U}\to [0,1]$ subordinate to $\{\Omega_\alpha\}$.
Consider the map $\map\:\spc{U}\to \spc{N}$ such that the barycentric coordinate of $\map(p)$ is $\phi_\alpha(p)$.
Note that $\map$ is locally Lipschitz. 
Clearly, the $\map$-preimage of any open simplex in $\spc{N}$ lies in $\Omega_\alpha$ for some $\alpha\in\IndexSet$.

For each $\alpha\in\IndexSet$, 
choose $x_\alpha\in\Omega_\alpha$.
Let us extend the map $\alpha\mapsto x_\alpha$
to a map $\Psi\:\spc{N}\to\spc{U}$ that is barycentric on each simplex.
According to \ref{thm:barycenter}, this extension exists, 
and $\Psi$ is locally Lipschitz.

\parit{\ref{SHORT.lem:approximation-cba:displacement}.}
Fix $x\in\spc{U}$. Denote by $\Delta$ the minimal simplex that contains $\map(x)$, 
and let $\alpha_0,\alpha_1,\dots,\alpha_n$ be the vertexes of $\Delta$.
%Denote by $\Delta$ the minimal simplex that contains $\map(x)$;
%and let $(\alpha_0,\alpha_1,\dots,\alpha_n)$ be the vertices of $\Delta$.
Note that $\alpha$ is a vertex of $\Delta$ if and only if $\phi_{\alpha}(x)>0$.
Thus
\[\dist{x}{x_{\alpha_i}}{}<\tfrac{1}{3}\cdot\rho(x)\] 
for any $i$.
Therefore 
\[\diam\Psi(\Delta)
\le
\max_{i,j}\{\dist{x_{\alpha_i}}{x_{\alpha_j}}{}\}
<
\tfrac{2}{3}\cdot\rho(x).\]
In particular, 
\[\dist{x}{\Psi\circ\map(x)}{}\le\dist{x}{x_{\alpha_0}}{}+\diam \Psi(\Delta) <\rho(x).\]

\parit{\ref{SHORT.lem:approximation-cba:im}.}
Assume the contrary;
that is, $\Psi(\spc{N})$ is not included in the $\Psi$-image of the $m$-skeleton of $\spc{N}$.
Then for some $\kay>m$,
there is a $\kay$-simplex $\Delta^\kay$ in $\spc{N}$
such that the barycentric simplex $\sigma=\Psi|_{\Delta^\kay}$ is nondegenerate; 
that is, 
$$W=\Psi(\Delta^\kay)\setminus\Psi(\partial\Delta^\kay)\ne \emptyset.
$$
By \ref{thm:bihoelder}, $\TopDim\spc{U}\ge \kay$ --- a contradiction.
\qeds

\parit{Proof of \ref{thm:dim-infty-CBA}; \ref{SHORT.thm:dim-infty-CBA:bary}$\Rightarrow$\ref{SHORT.thm:dim-infty-CBA:mnfld}$\Rightarrow$\ref{SHORT.thm:dim-infty-CBA:TopDim}.}
The implication \ref{SHORT.thm:dim-infty-CBA:bary}$\Rightarrow$\ref{SHORT.thm:dim-infty-CBA:mnfld} follows from Lemma~\ref{lem:nondeg-test-with-balls}
and Theorem~\ref{thm:bihoelder}, and \ref{SHORT.thm:dim-infty-CBA:mnfld}$\Rightarrow$\ref{SHORT.thm:dim-infty-CBA:TopDim} is trivial.
 
\parit{\ref{SHORT.thm:dim-infty-CBA:TopDim}$\Rightarrow$\ref{SHORT.thm:dim-infty-CBA:bary}.}
According to \ref{thm:stable-value}, 
there is a continuous map $F\:\spc{U}\to \RR^{m}$ with a stable value.

Fix $\eps>0$.
Since $F$ is continuous, there is a continuous positive function $\rho$ defined on $\spc{U}$ such that 
\[\dist{x}{y}{}<\rho(x)
\quad\Rightarrow\quad
|F(x)- F(y)|<\tfrac13\cdot\eps.\]
Apply \ref{lem:approximation-cba} to $\rho$.
For the resulting simplicial complex $\spc{N}$ 
 and the maps $\map\:\spc{U}\to \spc{N}$, $\Psi\:\spc{N}\to \spc{U}$, we have
\[|F\circ \Psi\circ\map(x)-F(x)|<\tfrac13\cdot\eps\] 
for any $x\in \spc{U}$.

Arguing by contradiction,
assume $\TopDim\spc{U}<m$.
By \ref{lem:approximation-cba:im},
the image $F_\eps\circ\Psi\circ\map(K)$ lies in the $F_\eps$-image of the $(m-1)$-skeleton of $\spc{N}$;
In particular, it can be covered by a countable collection of Lipschitz images of $(m-1)$-simplexes.
Hence
$\bm{0}\in \RR^m$ is not a stable value of  $F_\eps\circ\Psi\circ\map$.
Since $\eps>0$ is arbitrary, we get the result.
\qeds

\section{Remarks}

The barycenters in $\CAT(\kappa)$ spaces were introduced by Bruce Kleiner \cite{kleiner}.
He also proved the dimension theorem; an improvement was made by Alexander Lytchak \cite{lytchak:diff}.

It is not known if the dimension theorem holds for arbitrary complete geodesic $\CAT(\kappa)$ spaces.
It was conjectured by Bruce Kleiner \cite{kleiner}, see also \cite[p.~133]{gromov:asymt-inv}.
The answer is ``yes'' for separable spaces \cite[Corollary 14.13]{alexander-kapovitch-petrunin-2025}.

